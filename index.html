<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
  <title>Ram Sir </title>
  <!-- Font Awesome 6 (free) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', 'Segoe UI', Roboto, system-ui, sans-serif;
    }

    body {
      background: #f5f9ff;
      color: #13294b;
      line-height: 1.5;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* header */
    .site-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.2rem 2rem;
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(8px);
      border-bottom: 2px solid #e0e9f5;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 800;
      background: linear-gradient(135deg, #183f6b, #2b5b9e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
    }

    .logo i {
      background: none;
      -webkit-text-fill-color: #2b5b9e;
      margin-right: 8px;
    }

    .nav-links a {
      margin-left: 2.5rem;
      text-decoration: none;
      font-weight: 600;
      color: #1e3a5f;
      transition: 0.2s;
      border-bottom: 2px solid transparent;
      padding-bottom: 4px;
    }

    .nav-links a:hover {
      border-bottom-color: #f5b342;
      color: #0a2647;
    }

    /* hero */
    .hero-section {
      background: linear-gradient(125deg, #102b47 0%, #1f4b7a 100%);
      color: white;
      border-radius: 0 0 3rem 3rem;
      padding: 3.5rem 2rem;
      margin-bottom: 3rem;
      box-shadow: 0 20px 30px -8px #102b4750;
      position: relative;
      overflow: hidden;
    }

    .hero-section::after {
      content: "⚡ DAX";
      font-size: 8rem;
      font-weight: 900;
      color: rgba(255,255,255,0.03);
      position: absolute;
      bottom: -20px;
      right: 20px;
      pointer-events: none;
      transform: rotate(-5deg);
    }

    .hero-content {
      max-width: 800px;
      position: relative;
      z-index: 2;
    }

    .hero-content h1 {
      font-size: clamp(2.5rem, 7vw, 4.5rem);
      font-weight: 800;
      line-height: 1.1;
      margin-bottom: 1rem;
    }

    .hero-content h1 i {
      color: #f5b342;
      font-size: 3rem;
      margin-right: 10px;
    }

    .hero-sub {
      font-size: 1.4rem;
      opacity: 0.9;
      margin-bottom: 1.8rem;
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .hero-badge {
      background: #ffffff20;
      backdrop-filter: blur(4px);
      padding: 0.5rem 1.8rem;
      border-radius: 60px;
      font-size: 1.1rem;
      border: 1px solid rgba(255,255,255,0.3);
      display: inline-block;
    }

    .hero-badge i {
      margin-right: 8px;
      color: #f5b342;
    }

    /* section titles */
    .section-title {
      font-size: 2.3rem;
      font-weight: 700;
      margin: 3.5rem 0 1.8rem 0;
      letter-spacing: -0.02em;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .section-title i {
      background: #1e3a5f;
      color: white;
      width: 55px;
      height: 55px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 30px;
      font-size: 1.7rem;
      box-shadow: 0 8px 18px #1e3a5f40;
    }

    /* cards */
    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }

    .info-card {
      background: white;
      border-radius: 2rem;
      padding: 2rem 1.8rem;
      box-shadow: 0 15px 30px -12px #afc6e0;
      border: 1px solid #e7eef9;
      transition: all 0.15s;
    }

    .info-card:hover {
      transform: scale(1.01);
      box-shadow: 0 20px 35px -8px #7a9bcb;
    }

    .info-card i {
      font-size: 2.5rem;
      color: #1e3a5f;
      margin-bottom: 1.2rem;
    }

    .info-card h3 {
      font-size: 1.6rem;
      margin-bottom: 1rem;
    }

    .info-card p {
      color: #2c3e5c;
    }

    .concept-group {
      background: #eef4fd;
      border-radius: 2rem;
      padding: 2rem;
      margin-top: 1.5rem;
    }

    .badge {
      background: #f5b342;
      color: #102b47;
      font-weight: 700;
      padding: 0.2rem 1rem;
      border-radius: 40px;
      display: inline-block;
      font-size: 0.8rem;
      letter-spacing: 0.5px;
    }

    /* comparison table */
    .comparison-table {
      background: white;
      border-radius: 2.5rem;
      padding: 2rem;
      box-shadow: 0 15px 30px #d9e2f0;
      overflow-x: auto;
    }

    .comparison-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .comparison-table th {
      background: #102b47;
      color: white;
      padding: 1rem 1.5rem;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .comparison-table td {
      padding: 1.2rem 1.5rem;
      border-bottom: 1px solid #cbd6e8;
      vertical-align: top;
    }

    .comparison-table tr:last-child td {
      border-bottom: none;
    }

    .comparison-table i {
      color: #f5b342;
      width: 24px;
    }

    /* formula card grid (reused from previous, upgraded) */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }

    .formula-card {
      background: white;
      border-radius: 2rem;
      padding: 1.8rem;
      box-shadow: 0 15px 30px -12px rgba(21, 50, 90, 0.2);
      border: 1px solid #deecfb;
      transition: 0.2s;
      display: flex;
      flex-direction: column;
    }

    .formula-card:hover {
      box-shadow: 0 25px 40px -12px #1e3a5f99;
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 1rem;
    }

    .card-num {
      background: #d3e3fc;
      color: #102b47;
      font-weight: 800;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 40px;
      font-size: 1rem;
    }

    .card-header h3 {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .dax-code {
      background: #0a1a2b;
      color: #c7eaff;
      padding: 1rem;
      border-radius: 1.2rem;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.9rem;
      border-left: 5px solid #f5b342;
      margin: 0.8rem 0 1rem;
      overflow-x: auto;
    }

    .desc, .purpose, .extra {
      margin-bottom: 0.8rem;
      font-size: 0.98rem;
    }

    .purpose {
      background: #f0f7ff;
      padding: 0.8rem 1.2rem;
      border-radius: 1rem;
      border-left: 4px solid #1e3a5f;
    }

    .extra {
      background: #f8fafc;
      padding: 0.8rem 1.2rem;
      border-radius: 1rem;
      border: 1px dashed #a0b8d4;
    }

    .tag {
      align-self: flex-start;
      background: #d9eafb;
      padding: 0.3rem 1.2rem;
      border-radius: 40px;
      font-weight: 600;
      font-size: 0.75rem;
      color: #113355;
      text-transform: uppercase;
      margin-top: 0.5rem;
    }

    .func-table {
      background: white;
      border-radius: 2rem;
      padding: 2rem;
      box-shadow: 0 15px 25px #cddef5;
      overflow-x: auto;
    }

    .func-table table {
      width: 100%;
      border-collapse: collapse;
    }

    .func-table th {
      background: #1e3a5f;
      color: white;
      padding: 0.8rem 1.2rem;
      text-align: left;
    }

    .func-table td {
      padding: 0.9rem 1.2rem;
      border-bottom: 1px solid #dae2f0;
      font-family: monospace;
    }

    .func-table tr:last-child td {
      border-bottom: none;
    }

    /* best practices */
    .practices-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }

    .tip-card {
      background: white;
      border-radius: 2rem;
      padding: 2rem;
      box-shadow: 0 8px 20px #b7d0e9;
      border-bottom: 6px solid #f5b342;
    }

    .tip-card i {
      font-size: 2rem;
      color: #1e3a5f;
    }

    footer {
      background: #0c2037;
      color: #d4e2f5;
      padding: 3rem 2rem 2rem;
      margin-top: 4rem;
      border-radius: 3rem 3rem 0 0;
    }

    .footer-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
    }

    @media (max-width: 700px) {
      .container { padding: 0 1rem; }
      .site-header { flex-direction: column; gap: 1rem; }
      .nav-links a { margin: 0 1rem; }
      .hero-content h1 { font-size: 2.5rem; }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="logo"><i class="fas fa-cubes"></i> DAX mastery · ram sir</div>
    <div class="nav-links">
      <a href="#why">why dax</a>
      <a href="#concepts">concepts</a>
      <a href="#formulas">formulas</a>
      <a href="#functions">functions</a>
      <a href="#best-practices">tips</a>
    </div>
  </header>

  <div class="container">
    <!-- HERO -->
    <section class="hero-section">
      <div class="hero-content">
        <h1><i class="fas fa-bolt"></i> Master Power BI DAX <br>with Ram Sir</h1>
        <div class="hero-sub">
          <span><i class="fas fa-database"></i> 100+ row retail dataset</span>
          <span><i class="fas fa-calculator"></i> 30 real DAX formulas</span>
        </div>
        <div class="hero-badge"><i class="fas fa-check-circle"></i> calculated columns · measures · quick measures · calculated tables</div>
        <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
          <span style="background: #f5b342; color: #0f2b4b; padding: 0.4rem 1.6rem; border-radius: 60px; font-weight: 700;"><i class="fas fa-chart-line"></i> live dataset: SalesData_100_Rows</span>
        </div>
      </div>
    </section>

    <!-- WHY DAX -->
    <section id="why" class="section-title"><i class="fas fa-question-circle"></i> Why DAX? · the engine behind Power BI</section>
    <div class="icon-grid">
      <div class="info-card"><i class="fas fa-rocket"></i><h3>Fast calculations</h3><p>DAX runs on in-memory columnar engine (VertiPaq) – billions of rows in seconds.</p></div>
      <div class="info-card"><i class="fas fa-brain"></i><h3>Rich business logic</h3><p>Time intelligence, filters, ranking, and dynamic segmentation become simple.</p></div>
      <div class="info-card"><i class="fas fa-chart-pie"></i><h3>Interactive measures</h3><p>Measures react to slicers, filters, and visuals – real-time analytics.</p></div>
      <div class="info-card"><i class="fas fa-table"></i><h3>Row & filter context</h3><p>Two evaluation contexts make DAX uniquely powerful for tabular models.</p></div>
    </div>

    <!-- CORE CONCEPTS -->
    <section id="concepts" class="section-title"><i class="fas fa-cogs"></i> Core DAX concepts</section>
    <div class="concept-group">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap:2rem;">
        <div><span class="badge"><i class="fas-regular fa-layer-group"></i> row context</span><p style="margin-top:0.7rem;">When a formula is evaluated for each row of a table (calculated columns, iterators like SUMX).</p><code style="background:#ffffffaa; padding:0.2rem 1rem; border-radius:30px;">TotalRevenue = Quantity * SalesAmount</code></div>
        <div><span class="badge"><i class="fas fa-filter"></i> filter context</span><p>Filters applied from slicers, visuals, or CALCULATE. Measures always respect filter context.</p><code style="background:#ffffffaa; padding:0.2rem 1rem; border-radius:30px;">CALCULATE([Total Sales], Region = "West")</code></div>
        <div><span class="badge"><i class="fas fa-exchange-alt"></i> context transition</span><p>When row context is transformed into filter context inside CALCULATE (used in measures).</p><code style="background:#ffffffaa; padding:0.2rem 1rem; border-radius:30px;">SUMX( Sales, CALCULATE( SUM(Product[Price]) ) )</code></div>
      </div>
    </div>

    <!-- FUNCTION CATEGORIES (icons) -->
    <section class="section-title"><i class="fas fa-tags"></i> DAX function categories</section>
    <div class="icon-grid">
      <div class="info-card"><i class="fas fa-calculator"></i><h3>Aggregation</h3><p>SUM, AVERAGE, MIN, MAX, COUNTROWS, DISTINCTCOUNT</p></div>
      <div class="info-card"><i class="fas fa-clock"></i><h3>Time intelligence</h3><p>TOTALYTD, SAMEPERIODLASTYEAR, DATEADD, DATESBETWEEN</p></div>
      <div class="info-card"><i class="fas fa-link"></i><h3>Filter & relationship</h3><p>CALCULATE, FILTER, ALL, ALLEXCEPT, RELATED, USERELATIONSHIP</p></div>
      <div class="info-card"><i class="fas fa-font"></i><h3>Text & logical</h3><p>IF, SWITCH, FORMAT, CONCATENATE, SEARCH, TRUE/FALSE</p></div>
      <div class="info-card"><i class="fas fa-list-ol"></i><h3>Information / table</h3><p>ISBLANK, HASONEVALUE, VALUES, SUMMARIZE, TOPN, RANKX</p></div>
    </div>

    <!-- COMPARISON: COLUMN VS MEASURE -->
    <section class="section-title"><i class="fas fa-balance-scale"></i> Column vs Measure · when to use what</section>
    <div class="comparison-table">
      <table>
        <thead><tr><th></th><th>Calculated column</th><th>Measure</th></tr></thead>
        <tbody>
          <tr><td><i class="fas fa-bolt"></i> evaluation</td><td>Row by row, at refresh / data load</td><td>On the fly, in filter context (dynamic)</td></tr>
          <tr><td><i class="fas fa-memory"></i> storage</td><td>Consumes RAM/disk (materialized)</td><td>No storage – query time only</td></tr>
          <tr><td><i class="fas fa-chart-simple"></i> usage</td><td>Row-level result, can be used in slicers, axes</td><td>Aggregations, KPI, percentages, dynamic calculations</td></tr>
          <tr><td><i class="fas fa-code"></i> example</td><td>OrderMonth = FORMAT(OrderDate,"MMMM")</td><td>Total Sales = SUM(SalesAmount)</td></tr>
        </tbody>
      </table>
    </div>

    <!-- 30 DAX FORMULAS (cards) - data from original list, enriched -->
    <section id="formulas" class="section-title"><i class="fas fa-list-ul"></i> 30 DAX formulas – explained with purpose & variations</section>
    <div id="dax-card-container" class="card-grid"></div>

    <!-- COMMON FUNCTIONS TABLE -->
    <section id="functions" class="section-title"><i class="fas fa-table"></i> common DAX functions – quick reference</section>
    <div class="func-table" id="common-functions-table"></div>

    <!-- BEST PRACTICES -->
    <section id="best-practices" class="section-title"><i class="fas fa-medal"></i> best practices & pro tips</section>
    <div class="practices-grid">
      <div class="tip-card"><i class="fas fa-leaf"></i><h3>use variables</h3><p>VAR / RETURN improves readability and performance – store intermediate results.</p><code>VAR Sales2019 = CALCULATE([Total Sales], YEAR(OrderDate)=2019) RETURN Sales2019</code></div>
      <div class="tip-card"><i class="fas fa-ban"></i><h3>avoid bidirectional filters</h3><p>Unless needed, they can slow down models. Use one‑direction with CALCULATE.</p></div>
      <div class="tip-card"><i class="fas fa-chart-line"></i><h3>time intelligence requires date table</h3><p>Mark as date table with continuous dates for functions like TOTALYTD.</p></div>
      <div class="tip-card"><i class="fas fa-magnifying-glass"></i><h3>use DIVIDE instead of /</h3><p>DIVIDE handles division by zero gracefully (third argument optional).</p></div>
      <div class="tip-card"><i class="fas fa-layer-group"></i><h3>prefer measures over columns</h3><p>If a calculation can be a measure, avoid storing it as column – saves memory.</p></div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="footer-inner">
      <div><i class="fas fa-crown" style="color: #f5b342;"></i> Master DAX with Ram Sir – retail dataset deep dive</div>
      <div>⚡ 30 hands‑on formulas · responsive · all devices</div>
      <div>© 2026 · dax mastery</div>
    </div>
  </footer>

  <script>
    (function() {
      // Same data as before but we can enrich if needed.
      const columnFormulas = [
        { num: 1, name: 'TotalRevenue', formula: 'TotalRevenue = Quantity * SalesAmount', description: 'Multiplies quantity by unit price (extended amount).', purpose: 'Row‑level revenue for further calculations.', extra: 'Also TotalCost = Quantity * Cost' },
        { num: 2, name: 'NetProfit', formula: 'NetProfit = SalesAmount - Cost', description: 'Profit per transaction.', purpose: 'Identify loss‑making orders.', extra: 'ProfitMargin = DIVIDE(NetProfit, SalesAmount)' },
        { num: 3, name: 'DiscountRate', formula: 'DiscountRate = DIVIDE(Discount, SalesAmount, 0)', description: 'Discount percentage (safe division).', purpose: 'Analyze discount patterns.', extra: 'Use with AVERAGE in measures' },
        { num: 4, name: 'IsHighValueOrder', formula: 'IsHighValueOrder = IF(SalesAmount > 1000, "High", "Low")', description: 'Flags orders >1000.', purpose: 'Segment for quick filtering.', extra: 'SWITCH for multiple tiers' },
        { num: 5, name: 'OrderMonth', formula: 'OrderMonth = FORMAT(OrderDate, "MMMM")', description: 'Full month name.', purpose: 'Axis labels & grouping.', extra: 'FORMAT(,"MMM") for short name' },
        { num: 6, name: 'ProfitMargin', formula: 'ProfitMargin = DIVIDE(Profit, SalesAmount, 0)', description: 'Profit ratio at row level.', purpose: 'Drill down to order profitability.', extra: 'Useful to average later' },
        { num: 7, name: 'IsLateDelivery', formula: 'IsLateDelivery = IF(DeliveryTimeDays > 5, TRUE(), FALSE())', description: 'Marks orders delivered after 5 days.', purpose: 'Track logistics performance.', extra: 'DeliveryStatus = IF(... "Late", "OnTime")' },
        { num: 8, name: 'Year', formula: 'Year = YEAR(OrderDate)', description: 'Extracts year.', purpose: 'Time intelligence base.', extra: 'Also MONTH, QUARTER' },
        { num: 9, name: 'OrderQuarter', formula: 'OrderQuarter = "Q" & FORMAT(OrderDate, "Q")', description: 'Q1, Q2...', purpose: 'Quarterly grouping.', extra: 'Use with sorting by date' },
        { num: 10, name: 'CustomerTier', formula: 'CustomerTier = SWITCH(TRUE(), SalesAmount > 5000, "Platinum", SalesAmount > 2000, "Gold", "Silver")', description: 'Tier based on order amount.', purpose: 'Segment customers.', extra: 'Better with SUM per customer (measure)' }
      ];
      const measureFormulas = [
        { num: 11, name: 'Total Sales', formula: 'Total Sales = SUM(SalesAmount)', description: 'Base aggregation.', purpose: 'Core KPI.', extra: 'Use in cards, matrices.' },
        { num: 12, name: 'Total Profit', formula: 'Total Profit = SUM(Profit)', description: 'Sum of profit column.', purpose: 'Earnings measurement.', extra: 'Combine with CALCULATE.' },
        { num: 13, name: 'Average Discount', formula: 'Average Discount = AVERAGE(Discount)', description: 'Average discount amount.', purpose: 'Understand discounts.', extra: 'Average rate = AVERAGEX(..., Discount/SalesAmount).' },
        { num: 14, name: 'Profit %', formula: 'Profit % = DIVIDE([Total Profit], [Total Sales], 0)', description: 'Profit margin ratio.', purpose: 'High‑level margin.', extra: 'Format as %.' },
        { num: 15, name: 'Unique Customers', formula: 'Unique Customers = DISTINCTCOUNT(CustomerID)', description: 'Unique customer count.', purpose: 'Customer base size.', extra: 'New customers = CALCULATE(...)' },
        { num: 16, name: 'Average Order Value', formula: 'Average Order Value = AVERAGE(SalesAmount)', description: 'Average per order.', purpose: 'Basket size trend.', extra: 'DIVIDE([Total Sales], [Total Orders])' },
        { num: 17, name: 'Total Orders', formula: 'Total Orders = COUNTROWS(SalesData)', description: 'Number of rows.', purpose: 'Volume tracking.', extra: 'COUNTROWS is faster than COUNT(OrderID).' },
        { num: 18, name: 'High Value Orders', formula: 'High Value Orders = CALCULATE(COUNTROWS(SalesData), SalesAmount > 1000)', description: 'Count of high‑value orders.', purpose: 'Monitor premium transactions.', extra: 'Threshold dynamic possible.' },
        { num: 19, name: 'Return Rate', formula: 'Return Rate = DIVIDE( CALCULATE(COUNTROWS(SalesData), ReturnRequested = TRUE()), [Total Orders], 0 )', description: '% orders returned.', purpose: 'Quality check.', extra: 'Return $ amount also possible.' },
        { num: 20, name: 'Online Sales %', formula: 'Online Sales % = DIVIDE( CALCULATE([Total Sales], SalesChannel = "Online"), [Total Sales], 0 )', description: 'Share of online channel.', purpose: 'Channel performance.', extra: 'Offline % similarly.' }
      ];
      const quickMeasures = [
        { num: 21, name: 'Running Total Sales', formula: 'Running Total Sales = CALCULATE( [Total Sales], FILTER( ALLSELECTED(OrderDate), OrderDate <= MAX(OrderDate) ) )', description: 'Cumulative sales over time.', purpose: 'Trends, inventory.', extra: 'Works with any date column.' },
        { num: 22, name: 'YoY Growth %', formula: `YoY Growth % = 
VAR Current = [Total Sales]
VAR Previous = CALCULATE( [Total Sales], SAMEPERIODLASTYEAR(OrderDate) )
RETURN DIVIDE(Current - Previous, Previous, 0)`, description: 'Year‑over‑year change.', purpose: 'Annual performance.', extra: 'Requires date table or continuous dates.' },
        { num: 23, name: 'Sales Ranking', formula: 'Sales Ranking = RANKX( ALL(ProductName), [Total Sales] )', description: 'Product rank by sales.', purpose: 'Identify top performers.', extra: 'Use ALLSELECTED for dynamic.' },
        { num: 24, name: '% Profit Contribution', formula: '% Profit Contribution = DIVIDE( [Total Profit], CALCULATE( [Total Profit], ALL(ProductCategory) ), 0 )', description: 'Category profit share.', purpose: 'Category importance.', extra: 'Replace ALL with ALLSELECTED.' },
        { num: 25, name: 'Avg Delivery Time', formula: 'Avg Delivery Time = AVERAGE(DeliveryTimeDays)', description: 'Mean delivery days.', purpose: 'Logistics KPI.', extra: 'Filter by delivery status.' }
      ];
      const calcTables = [
        { num: 26, name: 'ReturnedOrders', formula: 'ReturnedOrders = FILTER( SalesData, ReturnRequested = TRUE() )', description: 'Table of returned orders.', purpose: 'Analyze returns.', extra: 'Add calculated columns in this table.' },
        { num: 27, name: 'TopCustomers', formula: 'TopCustomers = TOPN(10, SUMMARIZE(SalesData, CustomerName, "TotalSales", [Total Sales]), [TotalSales])', description: 'Top 10 customers.', purpose: 'Focus on key accounts.', extra: 'Include profit.' },
        { num: 28, name: 'SalesByRegion', formula: 'SalesByRegion = SUMMARIZE( SalesData, Region, "Sales", [Total Sales] )', description: 'Region‑wise sales.', purpose: 'Map ready summary.', extra: 'Add order count.' },
        { num: 29, name: 'OrdersPerMonth', formula: 'OrdersPerMonth = SUMMARIZE( SalesData, OrderMonth, "OrderCount", COUNT(OrderID) )', description: 'Monthly order counts.', purpose: 'Time series.', extra: 'Use month-year for sorting.' },
        { num: 30, name: 'DelayedDeliveries', formula: 'DelayedDeliveries = FILTER( SalesData, DeliveryStatus = "Delayed" )', description: 'Only delayed orders.', purpose: 'Root cause analysis.', extra: 'Add delivery time > 5.' }
      ];

      const commonFunctions = [
        { func: 'SUM(column)', desc: 'Adds all values in a column.' },
        { func: 'AVERAGE(column)', desc: 'Arithmetic mean.' },
        { func: 'COUNT(column)', desc: 'Counts non‑blank values.' },
        { func: 'COUNTROWS(table)', desc: 'Total rows.' },
        { func: 'DISTINCTCOUNT(column)', desc: 'Unique count.' },
        { func: 'DIVIDE(a,b,c)', desc: 'Safe division (c if zero).' },
        { func: 'IF(cond, true, false)', desc: 'Conditional.' },
        { func: 'SWITCH(TRUE(), ...)', desc: 'Multiple conditions.' },
        { func: 'CALCULATE(expr, filter...)', desc: 'Change filter context.' },
        { func: 'FILTER(table, cond)', desc: 'Return filtered rows.' },
        { func: 'FORMAT(value, fmt)', desc: 'Convert to string.' },
        { func: 'YEAR(date)', desc: 'Extracts year.' },
        { func: 'RANKX(table, expr)', desc: 'Ranking.' },
        { func: 'TOPN(n, table, order_by)', desc: 'Top n rows.' },
        { func: 'ALL(column/table)', desc: 'Remove filters.' },
        { func: 'ALLSELECTED(column)', desc: 'Keep visual filters.' },
        { func: 'MAX(column)', desc: 'Largest value.' },
        { func: 'VAR ... RETURN ...', desc: 'Variable declaration.' }
      ];

      function renderCards(dataArray) {
        return dataArray.map(item => `
          <div class="formula-card">
            <div class="card-header"><span class="card-num">${item.num}</span><h3>${item.name}</h3></div>
            <div class="dax-code">${item.formula.replace(/</g, '&lt;')}</div>
            <div class="desc"><i class="fas fa-info-circle" style="color:#1e3a5f;"></i> ${item.description}</div>
            <div class="purpose"><i class="fas fa-bullseye"></i> <strong>purpose:</strong> ${item.purpose}</div>
            <div class="extra"><i class="fas fa-code-branch"></i> <strong>variations:</strong> ${item.extra}</div>
            <div class="tag">${dataArray === columnFormulas ? 'calculated column' : dataArray === measureFormulas ? 'measure' : dataArray === quickMeasures ? 'quick measure' : 'calculated table'}</div>
          </div>
        `).join('');
      }

      document.getElementById('dax-card-container').innerHTML = 
        renderCards(columnFormulas) + 
        renderCards(measureFormulas) + 
        renderCards(quickMeasures) + 
        renderCards(calcTables);

      document.getElementById('common-functions-table').innerHTML = `
        <table><thead><tr><th>function</th><th>meaning</th></tr></thead>
        <tbody>${commonFunctions.map(f => `<tr><td>${f.func}</td><td>${f.desc}</td></tr>`).join('')}</tbody>
        </table>
      `;
    })();
  </script>
</body>
</html>
